# 使用 TensorFlow 实现 Word2Vec 中的 Skip-Gram 模型

```text
主要步骤：
1. 数据预处理
2. 数据采样
3. 训练数据构造
4. 网络的构建
5. 训练
6. 可视化
```

## 数据预处理
```text
数据预处理过程主要包括：
1. 替换文本中特殊符号并去除低频词
2. 对文本分词
3. 构建语料
4. 单词映射表
5. 首先我们定义一个函数来完成前两步，即对文本的清洗和分词操作。
```

## 数据采样
```text
`skip-gram` 中，训练样本的形式是 `(input word, output word)`，其中 `output word` 是 `input word` 的上下文。为了减少模型噪音并加速训练速度，我们在构造`batch`之前要对样本进行采样，剔除停用词等噪音因素。
对停用词进行采样，例如“你”， “我”以及“的”这类单词进行剔除。剔除这些单词以后能够加快我们的训练过程，同时减少训练过程中的噪音。
我们采用以下公式:
$$ P(w_i) = 1 - \sqrt{\frac{t}{f(w_i)}} $$
其中$ t $是一个阈值参数，一般为1e-3至1e-5。
$f(w_i)$ 是单词 $w_i$ 在整个数据集中的出现频次。
$P(w_i)$ 是单词被删除的概率。
>这个公式和论文中描述的那个公式有一些不同
```

## 运行结果
```text
Epoch 1/2 Iteration: 1000 Avg. Training loss: 5.0029 0.4139 sec/batch
****************************************************************************************************
Nearest to [丰田]: 时机, 雪地, 07, 抢, 车主, 换成, 顶, 吊,
Nearest to [发动机]: 怠速时, 2500, 阀体, 段时间, 祝, 压缩机, 电是, 档上,
Nearest to [刮伤]: 装个, 重启, 电路图, 却, 它会, 热胀冷缩, 删, 公里,
Nearest to [助力]: 液力, 中有, 设备, 记录仪, 最多, 凹, 烧掉, 店能,
Nearest to [方向机]: 阀体, 大约, 开时, 帮, 说法, 一面, 费用, 风速,
Nearest to [雨刮器]: 不, 一面, 告诉, 资料, 汽车装饰, 水泵, 远光, 转换,
****************************************************************************************************
Epoch 1/2 Iteration: 2000 Avg. Training loss: 4.3049 0.4267 sec/batch
****************************************************************************************************
Nearest to [丰田]: 07, 雪地, 抢, 换成, 时机, 吊, 车主, 新款,
Nearest to [发动机]: 怠速时, 2500, 阀体, 段时间, 档上, 手工, 电是, 松矿,
Nearest to [刮伤]: 装个, 热胀冷缩, 电路图, 它会, 重启, 方便, 删, 却,
Nearest to [助力]: 液力, 中有, 设备, 记录仪, 凹, 烧掉, 最多, 方向机,
Nearest to [方向机]: 阀体, 480, 一面, 风速, 大约, 开时, 助力, 费用,
Nearest to [雨刮器]: 不, 一面, 远光, 告诉, 变色, 三升, 快慢, 转换,
****************************************************************************************************
Epoch 1/2 Iteration: 3000 Avg. Training loss: 4.1863 0.4133 sec/batch
****************************************************************************************************
Nearest to [丰田]: 将来, 07, 抢, 换成, 雪地, 吊, 时机, 图文,
Nearest to [发动机]: 怠速时, 2500, 阀体, 松矿, 段时间, 档上, 压缩机, 手工,
Nearest to [刮伤]: 装个, 热胀冷缩, 电路图, 重启, 它会, 方便, 磕碰, 一两个,
Nearest to [助力]: 液力, 中有, 方向机, 设备, 助力器, 记录仪, 叽, 烧掉,
Nearest to [方向机]: 阀体, 480, 助力, 一面, 平衡杆, 大约, 风速, 费用,
Nearest to [雨刮器]: 不, 一面, 远光, 喷水, 变色, 一格, 三升, 卫星,
****************************************************************************************************
Epoch 1/2 Iteration: 4000 Avg. Training loss: 4.1733 0.4209 sec/batch
****************************************************************************************************
Nearest to [丰田]: 将来, 07, 抢, 换成, 雪地, 新款, 一对一, 进口,
Nearest to [发动机]: 怠速时, 2500, 阀体, 松矿, 段时间, 压缩机, 档上, 有力,
Nearest to [刮伤]: 装个, 热胀冷缩, 磕碰, 它会, 过保, 接合, 重启, 电路图,
Nearest to [助力]: 液力, 中有, 方向机, 助力器, 齿轮油, 设备, 叽, 助理,
Nearest to [方向机]: 助力, 480, 平衡杆, 阀体, 拉杆, 横, 一面, 大约,
Nearest to [雨刮器]: 一面, 远光, 喷水, 不, 一格, 卫星, 变色, 转换,
****************************************************************************************************
Epoch 2/2 Iteration: 5000 Avg. Training loss: 4.1188 0.1293 sec/batch
****************************************************************************************************
Nearest to [丰田]: 07, 将来, 抢, 进口, 新款, 雪地, 合资, 飞度,
Nearest to [发动机]: 怠速时, 2500, 阀体, 松矿, 档上, 压缩机, 有力, 段时间,
Nearest to [刮伤]: 装个, 磕碰, 热胀冷缩, 接合, 过保, 气囊, 重启, 高怠速,
Nearest to [助力]: 液力, 方向机, 助力器, 中有, 助理, 齿轮油, 叽, 设备,
Nearest to [方向机]: 助力, 480, 平衡杆, 阀体, 横, 拉杆, 一面, 打满,
Nearest to [雨刮器]: 远光, 喷水, 一面, 不, 卫星, 一格, 转换, 变色,
****************************************************************************************************
Epoch 2/2 Iteration: 6000 Avg. Training loss: 4.0905 0.4509 sec/batch
****************************************************************************************************
Nearest to [丰田]: 将来, 07, 进口, 抢, 新款, 合资, 雪地, 昂科威,
Nearest to [发动机]: 怠速时, 2500, 阀体, 松矿, 有力, 压缩机, 段时间, 咨询者,
Nearest to [刮伤]: 磕碰, 装个, 热胀冷缩, 气囊, 过保, 接合, 高怠速, 修,
Nearest to [助力]: 液力, 助力器, 方向机, 助理, 中有, 齿轮油, 叽, 驱动,
Nearest to [方向机]: 助力, 平衡杆, 拉杆, 480, 阀体, 横, 管柱, 转向,
Nearest to [雨刮器]: 喷水, 远光, 一面, 不, 卫星, 一格, 正电, 转换,
****************************************************************************************************
Epoch 2/2 Iteration: 7000 Avg. Training loss: 4.0656 0.5253 sec/batch
****************************************************************************************************
Nearest to [丰田]: 将来, 07, 进口, 抢, 合资, 一对一, 新款, 灰壳,
Nearest to [发动机]: 怠速时, 2500, 阀体, 松矿, 段时间, 有力, 压缩机, 咨询者,
Nearest to [刮伤]: 磕碰, 热胀冷缩, 装个, 接合, 过保, 气囊, 做漆, 下手,
Nearest to [助力]: 助力器, 方向机, 助理, 液力, 中有, 齿轮油, 驱动, 泵,
Nearest to [方向机]: 助力, 拉杆, 平衡杆, 阀体, 横, 打满, 管柱, 转向,
Nearest to [雨刮器]: 喷水, 远光, 一面, 不, 卫星, gs4, 一格, 雨,
****************************************************************************************************
Epoch 2/2 Iteration: 8000 Avg. Training loss: 4.0615 0.5313 sec/batch
****************************************************************************************************
Nearest to [丰田]: 将来, 07, 一对一, 抢, 进口, 灰壳, 合资, 图文,
Nearest to [发动机]: 怠速时, 2500, 松矿, 阀体, 有力, 段时间, 压缩机, 快到,
Nearest to [刮伤]: 磕碰, 热胀冷缩, 装个, 接合, 翼子板, 过保, 花纹, 做漆,
Nearest to [助力]: 助理, 助力器, 方向机, 液力, 齿轮油, 中有, 三年, 泵,
Nearest to [方向机]: 助力, 拉杆, 平衡杆, 横, 管柱, 打满, 阀体, 转向,
Nearest to [雨刮器]: 喷水, 远光, 一面, 一格, 雨, 卫星, gs4, 不,
****************************************************************************************************
Epoch 2/2 Iteration: 9000 Avg. Training loss: 4.0616 0.4610 sec/batch
****************************************************************************************************
Nearest to [丰田]: 将来, 07, 灰壳, 进口, 合资, 抢, 一对一, 斯巴鲁,
Nearest to [发动机]: 怠速时, 2500, 压缩机, 阀体, 有力, 松矿, 段时间, 泄气,
Nearest to [刮伤]: 磕碰, 热胀冷缩, 装个, 翼子板, 接合, 珍珠, 做漆, 气囊,
Nearest to [助力]: 助理, 助力器, 方向机, 液力, 齿轮油, 中有, 三年, 很沉,
Nearest to [方向机]: 助力, 拉杆, 平衡杆, 横, 管柱, 阀体, 打满, 下臂,
Nearest to [雨刮器]: 喷水, 远光, 一面, 雨, 一格, gs4, 卫星, 不,
****************************************************************************************************
```